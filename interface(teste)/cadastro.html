<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastrar Usuário</title>
    <!-- Adicione os links para o Bootstrap CSS e JS aqui -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="mb-4">Cadastrar Usuário</h1>
        <form id="usuarioForm">
            <div class="mb-3">
                <label for="nome" class="form-label">Nome:</label>
                <input type="text" class="form-control" id="nome" name="nome" required>
            </div>
            <div class="mb-3">
                <label for="cpf" class="form-label">CPF:</label>
                <input type="text" class="form-control" id="cpf" name="cpf" pattern="\d{3}\.\d{3}\.\d{3}-\d{2}" required>
            </div>
            <div class="mb-3">
                <label for="email" class="form-label">E-mail:</label>
                <input type="email" class="form-control" id="email" name="email" required>
            </div>
            
            <div class="mb-3">
                <label for="dataNascimento" class="form-label">Data de Nascimento:</label>
                <input type="date" class="form-control" id="dataNascimento" name="dataNascimento" required>
            </div>
            <div class="mb-3">
                <label for="sexo" class="form-label">Sexo:</label>
                <select class="form-control" id="sexo" name="sexo" required>
                    <option value="Masculino">Masculino</option>
                    <option value="Feminino">Feminino</option>
                    <option value="Outro">Outro</option>
                </select>
            </div>
            <div class="mb-3">
                <label for="cidade" class="form-label">Cidade:</label>
                <input type="text" class="form-control" id="cidade" name="cidade" required>
            </div>
            <div class="mb-3">
                <label for="estado" class="form-label">Estado (Sigla):</label>
                <input type="text" class="form-control" id="estado" name="estado" maxlength="2" required>
            </div>
            <button type="submit" class="btn btn-primary">Cadastrar</button>
        </form>
        <div id="resultado" class="mt-3"></div>
    </div>

    <!-- Adicione os links para o jQuery e Bootstrap JS aqui -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script>
        // Função para formatar automaticamente o CPF
        document.getElementById("cpf").addEventListener("input", function () {
            let cpf = this.value.replace(/\D/g, "");
            if (cpf.length > 11) {
                cpf = cpf.slice(0, 11);
            }
            if (cpf.length === 11) {
                cpf = cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, "$1.$2.$3-$4");
            }
            this.value = cpf;
        });

        // Função para lidar com o envio do formulário
        document.getElementById("usuarioForm").addEventListener("submit", function (event) {
            event.preventDefault();
            
            const nome = document.getElementById("nome").value;
            const cpf = document.getElementById("cpf").value;
            const email = document.getElementById("email").value;
            const dataNascimento = document.getElementById("dataNascimento").value;
            const sexo = document.getElementById("sexo").value;
            const cidade = document.getElementById("cidade").value;
            const estado = document.getElementById("estado").value;
            
            const data = {
                nome: nome,
                cpf: cpf,
                email: email,
                dataNascimento: dataNascimento,
                sexo: sexo,
                cidade: cidade,
                estado: estado
            };
            
            // Enviar os dados para a API Node.js usando Axios
            axios.post("http://localhost:8080/usuarios", data, {
                headers: {
                    "Content-Type": "application/json"
                }
            })
            .then(response => {
                document.getElementById("resultado").textContent = "Usuário criado com sucesso";
            })
            .catch(error => {
                console.error(error);
                document.getElementById("resultado").textContent = "Erro ao cadastrar usuário.";
            });
        });
    </script>
</body>
</html>
